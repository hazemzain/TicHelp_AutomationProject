# Maven CI/CD Pipeline
# Builds Java project, runs tests, and installs the required JDK.

trigger:
  - master

pool:
  name: 'Default'
  demands:
    - agent.name -equals HAZEMZAIN  # Ensure this matches the actual agent name

steps:
  - task: JavaToolInstaller@0
    inputs:
      versionSpec: '21'  # Use '11' if Maven needs Java 11
      jdkArchitecture: 'x64'

  - task: Maven@3
    inputs:
      mavenPomFile: 'pom.xml'
      mavenOptions: '-Xmx3072m'
      javaHomeOption: 'Path'  # Use 'Path' if Java is installed manually
      jdkVersionOption: '1.21'  # Ensure this matches the installed JDK version
      jdkArchitectureOption: 'x64'
      publishJUnitResults: true
      testResultsFiles: '**/surefire-reports/TEST-*.xml'
      goals: 'test'
