# Maven CI/CD Pipeline for Java
# Builds the project, installs JDK, and runs tests.

trigger:
  - master

pool:
  name: 'Default'
  demands:
    - agent.name -equals HAZEMZAIN  # Ensure this matches the actual agent name

steps:
  # Install JDK 21
  - task: JavaToolInstaller@0
    inputs:
      versionSpec: '21'  # Use '11' if Maven needs Java 11
      jdkArchitecture: 'x64'

  # Run Maven tests
  - task: Maven@3
    inputs:
      mavenPomFile: 'pom.xml'
      mavenOptions: '-Xmx3072m'
      javaHomeOption: 'Installed'  # âœ… Change from JDKVersion to Installed
      publishJUnitResults: true
      testResultsFiles: '**/surefire-reports/TEST-*.xml'
      goals: 'test'
